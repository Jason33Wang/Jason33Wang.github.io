<!DOCTYPE html>
<html lang="zh-Hans">





<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="花些无聊的时间；做点有趣的事">
  <meta name="author" content="Jason">
  <meta name="keywords" content="I came,I saw,I conquered.">
  <title>mysql笔记 - Jason&#39;s修禅房</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />
<link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/3.0.1/github-markdown.min.css" />

<!-- 主题依赖的图标库，不要自行修改 -->
<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_9n5xqdrq0nc.css">


  <link  rel="stylesheet" href="/lib/prettify/github-v2.min.css" />




<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


<link rel="alternate" href="/atom.xml" title="Jason's修禅房" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Jason's修禅房</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/">
              <i class="iconfont icon-home-fill"></i>
              Home</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/archives/">
              <i class="iconfont icon-archive-fill"></i>
              Archives</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/categories/">
              <i class="iconfont icon-category-fill"></i>
              Categories</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tags/">
              <i class="iconfont icon-tags-fill"></i>
              Tags</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/about/">
              <i class="iconfont icon-user-fill"></i>
              About</a>
          </li>
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/bg0.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
                <div class="mt-3 post-meta">
                  <i class="iconfont icon-date-fill" aria-hidden="true"></i>
                  <time datetime="2018-09-02 10:35">
                    Sunday, September 2nd 2018, 10:35 am
                  </time>
                </div>
              

              <div class="mt-1">
                
                  
                  <span class="post-meta mr-2">
                    <i class="iconfont icon-chart"></i>
                    5.6k 字
                  </span>
                

                
                  
                  <span class="post-meta mr-2">
                      <i class="iconfont icon-clock-fill"></i>
                    
                    
                    69
                     分钟
                  </span>
                

                
              </div>
            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
            <article class="markdown-body">
              <h1><span id="mysql学习笔记">mysql学习笔记</span></h1><h1><span id="sql的分类">sql的分类</span></h1><ul>
<li>数据查询语言（dql ：data query language）<ul>
<li>代表关键字：select</li>
</ul>
</li>
<li>数据操作语言（dml：data manipulation language）<ul>
<li>代表关键字：insert，delete，update</li>
</ul>
</li>
<li>数据定义语言（ddl：data definition language）<ul>
<li>代表关键字：create，drop，alter</li>
</ul>
</li>
<li>事物控制语言（tcl：transactional control language）<ul>
<li>代表关键字：commit，rollback</li>
</ul>
</li>
<li>数据控制语言（dcl：data control language）<ul>
<li>代表关键字：grant，revoke</li>
</ul>
</li>
</ul>
<pre class="line-numbers language-mysql"><code class="language-mysql">#创建数据库
create database fliename；
#选择数据库
use database_name
#查询当前数据库
select database();
#查询数据版本
select version();
#终止当前语句
\c
#退出mysql
\q,QUIT，EXIT
#显示命令
show databases
show tables
desc tabele_name
#查看怎么创建的某个表
show create table 【name】
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1><span id="查询语句">查询语句</span></h1><pre class="line-numbers language-mysql"><code class="language-mysql">#无所谓大小写
select 【字段，字段，字段】 from 表
#条件查询
select 【 】 from  表 where 表达式

找出工作岗位是manger和工作岗位是salesman的员工
######################################
select 
    ename，job
from
     emp
where
    job= 'manger' or job='salesman'；

等同于
select 
    ename,job
from
    emp
where
    job in ('manger','salesman')；

######################################3
like 用法： 其中%代表0～n个字符  _代表一个任意字符
select ename from emp where ename like '%o%'  模糊查询
###################################################


<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1><span id="升序排列降序排列">升序排列，降序排列</span></h1><pre class="line-numbers language-mysql"><code class="language-mysql">select ename，sal from emp order by sal asc；
#升序排列
select ename，sal from emp order by sal desc；
#降序排列
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h1><span id="数据处理函数单行处理函数">数据处理函数/单行处理函数</span></h1><table>
<thead>
<tr>
<th>Lower</th>
<th>转换成小写</th>
</tr>
</thead>
<tbody>
<tr>
<td>upper</td>
<td>转换成大写</td>
</tr>
<tr>
<td>substr</td>
<td>取子字符串（substr（被截取的字符串，起始下标，截取的长度））</td>
</tr>
<tr>
<td>length</td>
<td>去长度</td>
</tr>
<tr>
<td>trim</td>
<td>去空格</td>
</tr>
<tr>
<td>str_to_date</td>
<td>将字符串转换成日期</td>
</tr>
<tr>
<td>date_format</td>
<td>格式化日期</td>
</tr>
<tr>
<td>format</td>
<td>设置千分位</td>
</tr>
<tr>
<td>round</td>
<td>四舍五入</td>
</tr>
<tr>
<td>rand()</td>
<td>生成随机数</td>
</tr>
<tr>
<td>ifnull</td>
<td>可以将null转换成一个具体值</td>
</tr>
</tbody>
</table>
<h1><span id="关于mysql中的日期处理">关于mysql中的日期处理</span></h1><ul>
<li><p>每一个数据库处理日期的时候，采用的机制是不同的，日期处理都有自己的一套机制。所以在实际的开发中，表中的字段定义为DATA类型，这种情况很少。因为一旦使用日期类型，那么java程序将不能够通用那么在实际开发中，一般会使用”日期字符串“来表示日期</p>
</li>
<li><p>日期是数据库本身的特色，也是数据库本身机制中的一个重要的内容，所以还是需要掌握</p>
</li>
<li><p>MYSQL数据库管理系统中对日期提供了两个重要的函数：</p>
<p>-str_to_date</p>
<p>-date_format</p>
</li>
<li><p>str_to_date</p>
<p>该函数的作用是：将”日期字符串“转换成”日期类型“数据。【varchar—&gt;date】</p>
<p>该函数的执行结果是date类型</p>
<p>该函数的使用格式：</p>
<p>​               str_to_date(‘日期类型’,’日期格式’)</p>
<p>关于MYSQL中的日期格式：</p>
<pre><code>    回顾java中的日期格式：
</code></pre><p>​            yyyy        年</p>
<p>​            MM        月</p>
<p>​            dd        日</p>
<p>​            HH        时</p>
<p>​            mm        分</p>
<p>​            ss        秒</p>
<p>​            SSS        毫秒</p>
<p>java中将字符串转换成日期类型：</p>
<p>​    </p>
<pre class="line-numbers language-java"><code class="language-java">SimpleDateFormat sdf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span>（<span class="token string">"yyyy-MM-dd"</span>）
Date date <span class="token operator">=</span> sdf<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">"1970-10-10"</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>MYSQL的日期格式：</p>
<p>|  %Y  | 年   |<br>| :–: | —- |<br>|  %m  | 月   |<br>|  %d  | 日   |<br>|  %H  | 时   |<br>|  %i  | 分   |<br>|  %s  | 秒   |</p>
</li>
<li><p>案例：查询出1980-12-17入职的员工</p>
<pre class="line-numbers language-mysql"><code class="language-mysql">select ename from hirdate from emp where hirdate='1980-12-17'
#mysql默认的日期格式：%Y-%m-%d，以上的日期字符串'1980-12-17'正好和默认的日期格式一致，存在了自动类型转换，自动将日期字符串转换了日期类型，所以以上查询可以查询出结果。

#如果写下面语句则会报错
select ename from hirdate from emp where hirdate='12-17-1980'
#想要纠正错误可以改成以下语句
select ename from hirdate from emp where hirdate=str_to_date('12-17-1980','%m-%d-%Y')

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>date_format </p>
<ul>
<li><p>该函数的作用是：将日期类型date转换成具有特定格式的日期字符串varchar</p>
</li>
<li><p>该函数的运算结果是：varchar类型【具备特定格式的】</p>
</li>
<li><p>该函数的语法的格式：</p>
<p>​    date_format(日期类型数据，’日期格式’)</p>
</li>
<li><p>多用于查询操作</p>
</li>
</ul>
</li>
</ul>
<h1><span id="分组函数聚合函数多行处理函数">分组函数/聚合函数/多行处理函数</span></h1><table>
<thead>
<tr>
<th>count</th>
<th>取得记录数</th>
</tr>
</thead>
<tbody>
<tr>
<td>sum</td>
<td>求和</td>
</tr>
<tr>
<td>avg</td>
<td>取平均</td>
</tr>
<tr>
<td>max</td>
<td>取最大的数</td>
</tr>
<tr>
<td>min</td>
<td>取最小的数</td>
</tr>
</tbody>
</table>
<p>以上函数自动忽略空值，分组函数不能使用在where语句中</p>
<h1><span id="去除重复内容">去除重复内容</span></h1><p>distinct只能放在记录最前面</p>
<pre class="line-numbers language-mysql"><code class="language-mysql">select distinct job from emp；
select distinct deptno，job from emp；#将两个字段同时来看
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h1><span id="分组查询">分组查询</span></h1><ul>
<li><p>group by </p>
<ul>
<li><p>group by 【表示通过哪个或者哪些字段进行排序】</p>
</li>
<li><p>案例：找出每个工作岗位的最高薪水</p>
</li>
<li><p><code>`</code>mysql<br>#先按照工作岗位分组，使用max函数求每一组的最大值<br>select max(sal) from emp group by job<br>#其中 emp group by job 是一个整体<br>#表示先按照job分组，然后对每一组使用max（sal）求最高薪水</p>
</li>
</ul>
</li>
</ul>
<pre><code>#在这里有个坑
select ename,job,max(sal) from emp group by job
#在低版本的mysql中这个语句是可以执行的但是执行结果没有意义，这是由于语法在这方面比较松散，不严格。因为ename这个字段根本不是分组字段所以是不能放在select后面的。在其他数据库中比如oracle中时会报错的

#重点：若一条DQL语句中有group by 子句，那么select关键字后面只能跟参与分组的字段和分组函数
```
</code></pre><ul>
<li><p>having</p>
<ul>
<li><p>having和where功能相同都是为了完成数据的过滤</p>
</li>
<li><p>where和having后面都是添加条件</p>
</li>
<li><p>where在group by之前完成过滤</p>
</li>
<li><p>having在group 后面完成过滤</p>
</li>
<li><p>案例：找出每个工作岗位的平均薪水，要求显示平均薪水大于1500</p>
</li>
<li><pre class="line-numbers language-mysql"><code class="language-mysql">select job,avg(sal) from emp group by job having avg(sal)>1500
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>原则：</p>
<ul>
<li>尽量在where中过滤，无法过滤的数据，通常都是需要先分组之后再过滤的，这个时候可以选择使用having。</li>
</ul>
</li>
</ul>
</li>
<li><p>一个完整的DQL语句的总结：</p>
<p>select </p>
<p>​    ×××××</p>
<p>from</p>
<p>​    ×××××</p>
<p>where</p>
<p>​    ×××××</p>
<p>group</p>
<p>​    ×××××</p>
<p>having</p>
<p>​    ×××××</p>
<p>order by</p>
<p>​    ×××××</p>
<p>第一：以上的关键字顺序不能变，严格遵守</p>
<p>第二：执行顺序：</p>
<p>​    1、from                从某张表中检查数据</p>
<p>​    2、where            经过某条件进行过滤</p>
<p>​    3、group             然后分组</p>
<p>​    4、having            分组之后不满意在过滤</p>
<p>​    5、select            查询出来</p>
<p>​    6、order by            排序输出</p>
</li>
</ul>
<h1><span id="连接查询">连接查询</span></h1><ul>
<li><p>连接查询，也可以叫跨表查询，需要关联多个表进行查询</p>
</li>
<li><p>链接查询根据出现的年代分类：</p>
<ul>
<li>sql92</li>
<li>sql99</li>
</ul>
</li>
<li><p>链接查根据链接方式可以分为：</p>
<ul>
<li>内连接<ul>
<li>等值连接</li>
<li>非等值连接</li>
<li>自连接</li>
</ul>
</li>
<li>外连接<ul>
<li>左外连接</li>
<li>右外连接</li>
</ul>
</li>
<li>全连接【不讲，使用很少】</li>
</ul>
</li>
<li><p>当多张表进行连接查询，若没有任何条件限制，会发生什么现象？</p>
<p>案例1：查询每个员工所在的部门名称，要求最终显示员工名和对应的部门名。</p>
<ul>
<li><p>小知识点：在进行多表连接查询的时候，尽量给表起别名，这样效率高，可读性高。</p>
<pre class="line-numbers language-mysql"><code class="language-mysql">select e.ename,d.dname from emp e,dept d;
#如果不增加任何限制的话会出现笛卡尔积现象
#注意：连接查询过程中虽然使用了限制条件，但是匹配的次数没有减少，还是相乘次数，只不过这一次显示的结果都是有效记录
select e.ename,d.dname from emp e,dept d where e.xx = d.xx
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<p>案例2：找出每一个员工对应的工资等级，要求显示员工名，工资，工资等级</p>
<ul>
<li><pre class="line-numbers language-mysql"><code class="language-mysql">#sql99语法中的等值连接中的非等值连接
select e.ename,e.sal,s.grade from emp e 【inner】 join salgrade s on e.sal between s.local ans s.hisal
#sql92语法：
select e.ename,e.sal,s.grade from emp e ， salgrade s where e.sal between s.local ans s.hisal
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<p>案例3：找出每一个员工的上级领导，要求显示员工名以及对应的领导名</p>
<ul>
<li><pre class="line-numbers language-mysql"><code class="language-mysql">#同一张表，我们需要吧一张表看成两张表
#sql99语法中内连接中的非等值连接
select a.ename empname ,b.ename leadername from emp a 【inner】join emp b on a.mgr = b.empno;

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<p>案例4：找出每一个员工对应的部门名称，要求部门名称全部显示</p>
<ul>
<li><pre class="line-numbers language-mysql"><code class="language-mysql">#内连接：
#    a表和b表能够完全匹配的记录查询出来，就被称为内连接
#外连接：
#    a表和b表能够完全匹配的记录查询出来之外，将其中一张表的记录无条件的      完全查询出来，对方表没有匹配的记录，会自动模拟出null与之匹配，这种     查询被称为外链接。
    外连接查询的结果条数>=内连接的查询结果条数
#sql99语法：外连接中的右外连接【右连接】
select e.ename,d.dname from emp e right 【outer】 join dept d on e.deptno = deptno; #outer可以省略
#sql99语法：外连接中的左外连接【左连接】
select e.ename,d.dname from dept d left 【outer】 join emp e on e.deptno = deptno; #outer可以省略
#上面两种写法是相同的，任何一个右外连接都可以写成左外连接，反之同样成立

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>为什么inner和outer可以省略，加上去有什么好处？</p>
<ul>
<li>可以省略，因为区分内连接和外连接依靠的不是这些关键字，而是看sql             语句中是否存在right和left，若存在，表示一定是一个外连接，其他的都是内连接<ul>
<li>加上去的好处是增强可读性</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>  多张表进行表连接的语法格式：</p>
<p>  select   xxx  from  a </p>
<p>  join </p>
<p>  ​    b</p>
<p>  on</p>
<p>  ​    条件</p>
<p>  join</p>
<p>  ​    c</p>
<p>  on</p>
<p>  ​    条件；</p>
<p>  原理：</p>
<h1><span id="子查询">子查询</span></h1><p>1、什么是子查询？</p>
<ul>
<li>select语句嵌套select语句</li>
</ul>
<p>2、子查询可以出现在哪而？</p>
<ul>
<li><p>select…(select)</p>
<p>from…(select)</p>
<p>where..(select)</p>
</li>
</ul>
<p>3、where后面添加select子查询</p>
<p>案例：找出薪水比公司平均薪水高的员工，要求显示员工名和薪水。</p>
<ul>
<li><pre class="line-numbers language-mysql"><code class="language-mysql">select ename，sal from emp where sal > avg(sal)
#以上语句执行报错，分组函数不能直接使用在where后面

#正确做法
#第一步：找出公司的平均薪水
#第二部：找出薪水大于平均薪水的员工信息
select ename,sal from emp where sal > (select avg(sal) from emp)
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<p>4、from后面使用子查询</p>
<p>案例：找出每个部门的平均薪水，并且要求显示平均薪水的薪水等级。</p>
<p>第一步：找出每个部门的平均薪水</p>
<pre class="line-numbers language-mysql"><code class="language-mysql">select deptno, avg(sal) as avgsal from emp group by deptno;
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>第二步：将上面的临时查询结果当做临时表t，t表进行表连接，条件：t.avg(sal) between s.local and s.hisal</p>
<pre class="line-numbers language-mysql"><code class="language-mysql">select 
    t.deptno,t.avgsal,s.grade 
from 
    (select deptno, avg(sal) as avgsal from emp group by deptno) t
join
    salgrade s 
on 
    t.avgsal between s.local and s.hisal;

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>5、在select后面使用子查询【了解】</p>
<pre class="line-numbers language-mysql"><code class="language-mysql">select e.ename,(select d.dname from dept d where e,deptno = d.deptno) as dname from emp e;
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h1><span id="union">union</span></h1><p>union可以合并集合（相加）</p>
<pre class="line-numbers language-mysql"><code class="language-mysql">select    ename,job from emp where job = "manager"
union
select  ename,job from emp where job = "salesman"

#等同于以下写法
select ename,job from emp where job in ["manager","salesman"]
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1><span id="limit">limit</span></h1><ul>
<li>limit用来获取一张表中的某部分数据</li>
<li>limit只有在mysql数据库中存在，不通用，是mysql数据库管理系统的特色</li>
</ul>
<pre class="line-numbers language-mysql"><code class="language-mysql">#案例1：找出员工表中前5条记录
select ename from emp limit 5；
#以上的sql语句的“limit 5”中的5表示从表中记录下标0开始，取5条等同于下面的sql语句
select ename from emp limit 0,5；
#limit的使用语法格式：limit起始下标没有指定，默认从0开始，0表示表中第一条记录。

#案例2：找出公司中工资排名在前5名的员工
select ename,sal from emp order by sal desc limit 5;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>mysql中通用的分页sql语句：</li>
</ul>
<pre class="line-numbers language-mysql"><code class="language-mysql">#每页显示3条记录
每页显示3条记录
第1页：0,3
第2页：3,3
第3页：6,3
第4页：9,3
.。。。。
每页显示pagesize条记录
第pageNo页：（pageNo-1）×pagesize，pageSize

select ename,sal from emp order by sal desc limit （（pageNo-1）×pagesize，pageSize）;

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1><span id="表">表</span></h1><ul>
<li><p>创建表</p>
<ul>
<li>表格（table），用来存储数据，表格是一种结构化文件。</li>
<li>表格行被称为记录（表中的数据），表格列被称为字段。</li>
<li>表格的字段属性包括：字段名称、字段数据类型、字段长度、字段约束</li>
</ul>
</li>
<li><pre class="line-numbers language-mysql"><code class="language-mysql">create table tableName（
    columnName dataType(length),
    columnName dataType(length)
）;
set character_set_results='gbk';
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>关于mysql数据库中的数据类型？</p>
<ul>
<li>varchar        可变长度字符串<ul>
<li>空间效率高，时间效率低</li>
</ul>
</li>
<li>char                定长字符串<ul>
<li>时间效率高，但是空间效率不一定会高</li>
</ul>
</li>
<li>int                   整数型<ul>
<li>int(3)表示最大可以存储999</li>
</ul>
</li>
<li>bigint              长整形<ul>
<li>对应的java程序中的lon类型</li>
</ul>
</li>
<li>float                浮点型单精度</li>
<li>double            浮点型双精度<ul>
<li>double（7,2）表示7个有效数字，2个小数位</li>
</ul>
</li>
<li>date                日期类型<ul>
<li>在实际来发中为了通用，所以日期类型一般不适用，采用字符串代替日期类型比较多</li>
</ul>
</li>
<li>blob                 Binary Largre Object二进制大对象<ul>
<li>专门存储图片声音视频等数据</li>
<li>数据库表中存储一个图片是很常见的，但是存储一个比较大的视频是很少见的，一般都是提供一个视频的链接地址</li>
</ul>
</li>
<li>clob                  character Large Object字符大对象<ul>
<li>可以存储比较大的文本，4G+的字符串可以存储</li>
</ul>
</li>
<li>其他</li>
</ul>
</li>
</ul>
<h1><span id="insert">insert</span></h1><ul>
<li>向表格插入数据必须是使用insert语句，这属于dml语句</li>
<li>dml语句包括：insert，update，delete、</li>
<li>insert语句的语法格式：<ul>
<li>insert into tablename （columnname1，columnname2，columnname3）values（value1，value2，value3）</li>
</ul>
</li>
<li>字段和值必须一一对应，个数必须相同，数据类型必须一致。</li>
</ul>
<h1><span id="关于sql脚本">关于sql脚本</span></h1><ul>
<li>该文件是一个普通的文本文件，后缀名.sql，被称为sql脚本</li>
<li>在sql脚本中有大量的sql语句，想批量的执行sql语句，可以将这些sql语句写入sql脚本文件中，直接使用source执行这个脚本，可以执行大量的sql语句</li>
<li></li>
</ul>
<h1><span id="增删改表结构不是很重要ddl">增删改表结构(不是很重要)（DDL）</span></h1><pre class="line-numbers language-mysql"><code class="language-mysql">#如需求改变，需要向t_studnts中加联系电话字段，字段名称为：contact_tel 类型为varchar（40）
#增
alter table t_student add contact_tel varchar(40)
#将长度改为20
#改
alter table t_student modify tel varchar(20)
#删
alter table t_student drop tel
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1><span id="增删改表中的数据insert-update-delete">增删改表中的数据【insert、update、delete】</span></h1><h2><span id="update">update</span></h2><ul>
<li><p>update语句的语法格式：</p>
<ul>
<li>update tablename set 字段名 = 字段值，字段名 = 字段值，where 条件；</li>
</ul>
</li>
<li><p>注意：update语句没有条件，会将一张表中所有的数据全部更新</p>
</li>
<li><pre class="line-numbers language-mysql"><code class="language-mysql">#将no=3的记录name修改为zhangsan，email修改为zhangsan@bjpowernode.com
update t_student set name='zhangsan',email ='zhangsan@bjpowernode.com' where no = 3;
#将所有的name都修改为lisi
update t_student set name = 'lisi';
#将emp_bak中的所有的名字中含有o的员工名修改为zhangsan
update emp_bak set ename = 'zhangsan' where ename like '%o%';
#将emp_bak表中所有工作岗位是manager和salesman的员工工资上调10%
update emp_bak set sal=sal*1.1 where job = 'manager' or job = 'salesman'
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h2><span id="delete">delete</span></h2><ul>
<li><p>delete 语句的语法格式：</p>
<ul>
<li>delete from tablename where 条件</li>
</ul>
</li>
<li><p>注意：若没有条件限制，会将这种表中所有的记录全部删除</p>
</li>
<li><pre class="line-numbers language-mysql"><code class="language-mysql">#删除学号=3的学生
delete from t_student where no = 3
#删除所有记录
delete from t_student

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h1><span id="约束">约束</span></h1><ul>
<li><p>什么是约束，为什么要使用约束？</p>
<ul>
<li>约束对应的英语单词：constraint</li>
<li>约束实际上就是表中数据的限制条件</li>
<li>表在设计的时候加入约束的目的就是为了保证表中的记录完整和有效 </li>
</ul>
</li>
<li><p>约束包括哪些？</p>
<ul>
<li>非空约束            not null</li>
<li>唯一性约束             unique</li>
<li>主键约束                 primary key 简称PK</li>
<li>外键约束                 foreign key   简称FK</li>
<li>检查约束【目前mysql不支持，oracle支持】      </li>
</ul>
</li>
<li><p>非空约束</p>
<ul>
<li><p>not null约束的字段，不能为NULL值，必须给定具体的数据</p>
</li>
<li><p>创建表，给字段添加非空约束【创建用户表，用户名不能为空】</p>
</li>
<li><pre class="line-numbers language-mysql"><code class="language-mysql">create table t_user(
    id int(10),
    name varchar(32) not null not null,
    email varchar(128)
);
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
</li>
<li><p>唯一性约束</p>
<ul>
<li><p>unique约束的字段具有唯一性，不可重复</p>
</li>
<li><pre class="line-numbers language-mysql"><code class="language-mysql">#创建用户，保证邮箱地址唯一
#列级约束
create table t_user(
    id int(10),
    name varchar(32) not null not null,
    email varchar(128) unique
);
#表级约束
create table t_user(
    id int(10),
    name varchar(32) not null not null,
    email varchar(128) ，
    unique（email）
);
#注意，使用表级约束给多个字段联合添加约束【以下程序表示name和email两个字段联合唯一】
create table t_user(
    id int(10),
    name varchar(32) not null not null,
    email varchar(128) ，
    unique（name,email）
);

#表级约束还可以给约束起名字
#为什么要起名字，因为以后可以通过这个名字删除这个约束
drop table if exist t_user;
create table t_user(
    id int(10),
    name varchar(32) not null not null,
    email varchar(128) ，
    constraint t_user_email_unique unique（name,email）
);
#查询约束名字
use information_schema;
show tables;
#其中有个表叫table_constraint的表专门用来存储约束信息的
select constraint_name from table_constraints where table_name='t_user';

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
</li>
<li><p>主键约束-primary key 简称PK</p>
<ul>
<li><p>主键涉及到的术语：</p>
<ul>
<li>主键约束</li>
<li>主键字段</li>
<li>主键值</li>
</ul>
</li>
<li><p>以上的主键约束、主键字段、主键值的关系？</p>
<ul>
<li>表中的某个字段添加主键约束之后，该字段被称为主键字段，主键字段中出现的每一个数据都被称为主键值。</li>
</ul>
</li>
<li><p>给某个字段添加主键约束primary key后，该字段不能重复，并且也不能为空。效果和not null unique相同，但是本质不同，主键约束除了可以做到not null unique之外，主键字段还会默认添加“索引-index”</p>
</li>
<li><p>一张表应该有主键字段，若没有，表示这张表是无效的。“主键值”是当前行数据的唯一标识。“主键值”是当前行数据的身份证号。即使表中的两行记录相关的数据是相同的，但是由于主键值不同，我们认为这是两行完全不同的数据。</p>
</li>
<li><p>给一个字段添加主键约束，被称为单一主键。</p>
</li>
<li><pre class="line-numbers language-mysql"><code class="language-mysql"> #单一主键
 #列表定义方式
   drop table if exist t_user;
   create table t_user( 
     id int(10) primary key,
    name varchar(32)
   )
   #单一主键
   #列表定义方式
   drop table if exist t_user;
   create table t_user(
     id int(10),
    name varchar(32)，
    primary key（id）
   )
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>
</code></pre></li>
<li></li>
<li><p>给多个字段联合添加一个主键约束，被称为复合主键。</p>
</li>
<li><p>无论是单一主键还是复合主键，一张表主键约束只能有一个</p>
</li>
<li><p>主键根据性质分类：</p>
<ul>
<li>自然主键<ul>
<li>主键值若是一个自然数，这个自然数和当前表的业务没有任何关系，这种主键叫做自然主键 。</li>
</ul>
</li>
<li>业务主键<ul>
<li>主键值若和当前表中业务紧密相关的，那么这种主键值被称为业务主键，当业务数据发生改变的时候，主键值通常会受到影响，所以业务主键使用较少。大部分都是使用自然主键。</li>
</ul>
</li>
</ul>
</li>
<li><p>在mysql数据库管理系统中提供了一个自增的数字，专门用来自动生成主键值。主键值不需要用户维护，也不需要用户提供了，自动生成的。这个自增的数字默认从1开始，以1递增：1、 2、 3、 …….</p>
<ul>
<li><pre class="line-numbers language-mysql"><code class="language-mysql">drop table if exist t_uesr;
create table t_user(
    id int(10) primary key auto_increment,
    name varchar(32)
)
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<code>`</code></li>
</ul>
<p><code>`</code></p>
</li>
</ul>
</li>
<li><p>外键约束 foreign key 简称FK</p>
<ul>
<li><p>外键涉及到的术语</p>
<ul>
<li>外键约束</li>
<li>外键字段</li>
<li>外键值</li>
</ul>
</li>
<li><p>外键约束、外键字段、外键值之间的关系？</p>
<ul>
<li>某个字段添加外键约束之后，该字段称为外键字段，外键字段中的每一个数据都是外键值。</li>
</ul>
</li>
<li><p>外键也分为：单一外键和复合外键（联合多个字段添加一个外键）</p>
</li>
<li><p>一张表中可以有多个外键字段。</p>
</li>
<li><p>分析场景：</p>
<p>请设计数据库用来存储学生和班级信息，给出两种解决方案：</p>
<p>学生信息和班级信息之间的关系，一个班级对应多个学生，这是典型的一对多的关系。</p>
<p>第一种设计方案：将学生信息和班级信息存储到一张表中。</p>
<p>学生信息表t_student</p>
<p>sno(pk)             sname               classno                     cname</p>
<hr>
<p>1                         jack                   100                            实验中学1班</p>
<p>2                         allen                 200                             实验中学2班</p>
<p>3                         lucy                   200                            实验中学2班                     </p>
<p>4                         lisi                     300                            实验中学3班</p>
<p><u>以上设计缺点：数据冗余</u></p>
<p>第二种解决方案：将学生信息和班级信息分开两张表存储你，学生表 + 班级表</p>
<p>学生表t_student</p>
<p>sno(pk)             sname            classno（fk）</p>
<hr>
<p>1                         jack                   100</p>
<p>2                         allen                 200</p>
<p>3                         lucy                  200</p>
<p>4                         lisi                     300</p>
<p>班级表t_class</p>
<p>cno(pk)       cname</p>
<hr>
<p>100               实验中学1班</p>
<p>200               实验中学2班</p>
<p>300               实验中学3班</p>
<p>结论：为了保证t_student表中的classno字段中的数据必须来自于t_class表中cno字段中的数据，有必要给t_student表中的classno字段添加外键约束，classno字段被称为外键字段，该字段中的100、 200、 300、被称为外键值。classno这里是一个单一外键字段</p>
<p>注：外键值可以为null。</p>
<p>注：外键字段去引用一张表的某一个字段的时候，被引用的字段必须具有unique约束。</p>
<p>注：有了外键引用之后，表分为父表和子表，以上父表是：班级表，子表是：学生表。创建表先创建父表，在创建子表，删除数据的时候，先删除子表中的数据，后删除父表中的数据。插入数据的时候先插入父表中的数据，再插入子表中的数据</p>
<pre class="line-numbers language-mysql"><code class="language-mysql">
insert into t_student(sno,sname,classno) value(1,'',100);
insert into t_student(sno,sname,classno) value(1,'',100);drop table if exists t_student;
drop table if exists t_class;
create table t_class(
    cno int(3) primary key,
    cname varchar(128) not null unique
);
create table t_students(
    sno int(3) primary key,
    sname varchar(32) not null,
    classno int(3),
    constraint t_student_classno_fk foreign key(classno) reference t_class(cno)
);
insert into t_class(cno,cname) value(100,'高三一班')；
insert into t_class(cno,cname) value(200,'高三二班')；
insert into t_class(cno,cname) value(300,'高三三班')；
insert into t_student(sno,sname,classno) value(1,'jack',100);
insert into t_student(sno,sname,classno) value(2,'tom',100);
insert into t_student(sno,sname,classno) value(3,'lucy',200);
insert into t_student(sno,sname,classno) value(4,'king',200);
insert into t_student(sno,sname,classno) value(5,'wang',300);
insert into t_student(sno,sname,classno) value(6,'lisi',300);
select * from t_studengt;
select * from t_class;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>重点：典型的一对多的设计模式，在多的一方加外键。</p>
</li>
</ul>
</li>
</ul>
<h1><span id="级联更新和经联删除">级联更新和经联删除</span></h1><ul>
<li>添加级联更新和级联删除的时候需要在外键约束后面添加</li>
<li>在删除父表中的数据时，级联删除子表中的数据 on delete cascade<ul>
<li>删除外键约束<ul>
<li>alter table t_student drop foreign key fk_name;</li>
</ul>
</li>
<li>添加外键约束<ul>
<li>alter table t_student add constraint   fk_name foreign key (classno) references t_class(cno) on delete cascade</li>
</ul>
</li>
</ul>
</li>
<li>在更新父表中的数据时，级联更新子表中的数据 on update cascade<ul>
<li>删除外键约束<ul>
<li>alter table t_student drop foreign key fk_name;</li>
</ul>
</li>
<li>添加外键约束<ul>
<li>alter table t_student add constraint   fk_name foreign key (classno) references t_class(cno) on update cascade</li>
</ul>
</li>
</ul>
</li>
<li>以上的级联更新和级联删除谨慎使用，因为级联操作会将数据改变或者删除【数据无价】</li>
</ul>

            </article>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/数据库/">数据库</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/mysql/">mysql</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" rel="nofollow noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                      <a href="/2018/09/02/正能量/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">苟有恒，何必三更睡五更起。最无益，莫过一日曝十日寒</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/2018/08/02/hello-world/">
                        <span class="hidden-mobile">blog初级自定义自定义教程</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

            
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div>
    

    

    
  </div>
</footer>

<!-- SCRIPTS -->
<div id="hitokoto" style="text-align:center">D 获取中...</div>
<script>
  fetch('https://v1.hitokoto.cn')
    .then(response => response.json())
    .then(data => {
      const hitokoto = document.getElementById('hitokoto')
      hitokoto.innerText = data.hitokoto
      })
      .catch(console.error)
</script>
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/main.js" ></script>


  <script  src="/js/lazyload.js" ></script>



  
  <script  src="https://cdn.staticfile.org/tocbot/4.10.0/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '.post-content',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>





  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>






<!-- Plugins -->



  <script  src="https://cdn.staticfile.org/prettify/188.0.0/prettify.min.js" ></script>
  <script>
    $(document).ready(function () {
      $('pre').each(function () {
        const pre = $(this);
        if (pre.find('code.mermaid').length > 0) {
          return;
        }
        pre.addClass('prettyprint  linenums');
      });
      prettyPrint();
    })
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "mysql笔记&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      getSearchFile(path);
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>


















<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>
</html>
